{% extends "base.html" %}
{% block content %}

<!-- OLD Compiled and minified CSS for correct formatting of checkboxes -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

<!-- OLD Compiled and minified JavaScript for correct formatting of checkboxes -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

<!-- Must import again to supersede the newest materialize imports -->
<link rel="stylesheet" href="static/css/custom.css">

<!-- To enable us call a function synchronously in routes.py -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<h4>sbMACRO Database Update</h4>

<br>
<h5><b>Clicking 'Submit' will update the Master Search Tables by default</b>. You may select CASCs to be updated in addition.</h5>
<br>

<h6>Select CASC(s) to update:</h6>
<form method="POST" id="CASC-Select-Form">

  <div class="row">
    <div class="col s4 m4 l4">
        <div class="card blue-grey lighten-4">
            <div class="card-content">
              {% for casc_name in list_of_cascs: %}
                  {% set field_name = casc_name %}
                  {% set field = form|attr(field_name) %}
                  <br> {{ form|attr(field_name)(class="FY-Checkbox") }} {{ field.label }}
              {% endfor %}
            </div>
        </div>
    </div>
  </div>

  <div class = "row">
    {{ form.submit(class="btn btn-primary") }}
  </div>
  {{ form.hidden_tag() }}

</form>

<!-- <h5>OR:</h5>

<div>
  <a id = "refresh_master_details" 
  class = "waves-effect waves-light btn" 
  onclick = "refresh_master_details()">Refresh_Search_Tables</a>
</div>
<br> -->

<script src="{{ url_for('main.static', filename='js/updateDB.js') }}"></script>
<script>

  // function refresh_master_details() {
  //   var someVar = $.ajax({
  //      method: "POST",
  //      url: "{{ url_for('main.update_db') }}",
  //      async: true,
  //      data: { refresh_master_details: 'yes' }
  //   });

  //   return ' ';
  // }

  let currentPage = document.getElementById('Nav-Update');
  currentPage.classList.add("currentPage");
</script>

{% endblock %}
